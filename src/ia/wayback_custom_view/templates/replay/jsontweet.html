<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Wayback Machine</title>
    <style type="text/css">
			body {
				margin:0;
				padding: 20px;
				background-color: #000;
				min-height: 100vh;
				box-sizing: border-box;
			}
      .notice {
        border: 2px solid #c9ae00;
        background-color: #ffff00;
        padding: 12px;
      }

      .tweet-container {
        font-family: Helvetica, Arial, sans-serif;
        padding: 12px 16px;
        border: 1px solid #cfd9de;
        border-radius: 12px;
        max-width: 600px;
        margin-top: 20px;
				margin-left: auto;
				margin-right: auto;
				background-color: white;
      }

      .tweet-author {
        display: flex;
        flex-direction: row;
        align-items: center;
        padding-bottom: 0.75rem;
      }

      .tweet-author-profile-image img {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        margin-right: 5px;
      }

      .tweet-author-info {
        display: flex;
        flex-direction: column;
      }

      .tweet-author-name {
        font-weight: bold;
      }

      .tweet-content {
        font-size: 1.25rem;
      }

			.tweet-image {
				width: 100%;
				height: auto;
				margin-top: 12px;
				border-radius: 12px;
			}

			.embedded-tweet-container {
				box-sizing: border-box;
				margin-top: 12px;
				padding: 12px;
				border: 1px solid #cfd9de;
        border-radius: 12px;
				background-color: white;
				max-width: 100%;
			}
    </style>
  </head>
  <body>
    {% if error %}
    <div>error = {{ error }}</div>
    {% endif %} {% if parsed_content %}
    <div class="notice">
      This is a page generated by the Internet Archiveâ€™s Wayback Machine from Twitter/X post data
    </div>
    {% set data = parsed_content.data %}
    <div class="tweet-container">
      {% for user in parsed_content.includes.users %}
      {% if user.id == data.author_id %}
      <div class="tweet-author">
        <div class="tweet-author-profile-image">
          <img src="{{ context.make_replay_url(user.profile_image_url, flags=['im']) }}" alt="{{ user.name }}" />
        </div>
        <div class="tweet-author-info">
          <div class="tweet-author-name">{{ user.name }}</div>
          <div class="tweet-author-username">@{{ user.username }}</div>
        </div>
      </div>
      {% endif %}
      {% endfor %}
      <div class="tweet-content">{{data.text | replace('\n', '<br />') }}
				{% for media in media_array %}
					{% if media.type == "photo" %}
						<img class="tweet-image" src="{{ context.make_replay_image_url(media.url, flags=['im']) }}" />
					{% endif %}
					{% if media.type == "video" %}
						<video class="tweet-image tweet-video" controls>
							{% for variant in media.variants %}
								<source src="{{ context.make_replay_url(variant.url, flags=['im']) }}" type="{{ variant.content_type }}">
							{% endfor %}
						</video>
					{% endif %}
				{% endfor %}
				<!-- TODO: If there's a quoted tweet, embed it here! -->
				{% for tweet in quoted_tweets %}
					{% with tweet=tweet %}
						{% include 'replay/jsontweetquoted.html' %}
					{% endwith %}
				{% endfor %}
			</div>
			<script>
				const True = true;
				const False = false;
				console.log({{ parsed_content }});
				console.log("Media: ", {{ media_array }});
				console.log("Quoted tweets: ", {{ quoted_tweets }});
				</script>
    </div>
    {% endif %}
  </body>
</html>
